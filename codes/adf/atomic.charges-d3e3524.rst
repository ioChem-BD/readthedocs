.. _atomic.charges-d3e3524:

atomic.charges
==============

.. table:: Implementation level

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Type                                                                                                                       | Status                                                                                                                     |
   +============================================================================================================================+============================================================================================================================+
   | CML extraction template                                                                                                    | |image1|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | HTML5 representation                                                                                                       | |image2|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. table:: Template attributes

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Attribute                                                                                                                  | Value                                                                                                                      |
   +============================================================================================================================+============================================================================================================================+
   | *source*                                                                                                                   | ADF log                                                                                                                    |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | id                                                                                                                         | atomic.charges                                                                                                             |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | name                                                                                                                       | Multipole derived atomic charges                                                                                           |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | pattern                                                                                                                    | &#92;s*Multipole&#92;sderived&#92;satomic&#92;scharges.\*                                                                  |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | endPattern                                                                                                                 | &#92;s*&#92;d+&#92;s+[a-zA-Z]+.*$&#92;s\*                                                                                  |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | offset                                                                                                                     | -1                                                                                                                         |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | endOffset                                                                                                                  | 1                                                                                                                          |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | repeat                                                                                                                     | \*                                                                                                                         |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | xml:base                                                                                                                   | multipole/atomic.charges.xml                                                                                               |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. container:: formalpara-title

   **Input**

::

    --------------------------------------- 
    Multipole derived atomic charges (a.u.)
    --------------------------------------- 

    The MDC-m charges are just the Monopole terms in the multipole expansion, while for the MDC-d charges
    also the Dipoles are reconstructed. The usually preferred charges are the MDC-q charges.
    These reconstruct the Monopoles, Dipoles and Quadrupoles (both atomic AND molecular).

           Atom    Level:     MDC-m        MDC-d        MDC-q
    ---------------------------------------------------------
        1     C           -0.075557    -0.078482    -0.054478
        2     C           -0.084875    -0.084295    -0.061208
        3     C           -0.085796    -0.033633    -0.042267
        4     C           -0.080729    -0.032957    -0.040164
        5     C           -0.117513    -0.057666    -0.037879
        6     C           -0.010384    -0.016576     0.016869
        7     C           -0.014865    -0.013944     0.017432
        8     C           -0.039447     0.005299    -0.007335
        9     C           -0.035558     0.002807    -0.006280
       10     C           -0.140545    -0.112301    -0.069237
       11     C           -0.093525    -0.025081    -0.031398
       12     C           -0.087944    -0.021211    -0.021392
       13     C           -0.051656    -0.037707    -0.042409
       14     C           -0.063214    -0.036357    -0.045044
       15     C           -0.059823    -0.080014    -0.046854
       16     C           -0.057707    -0.086737    -0.045563
       17     C           -0.174511    -0.110768    -0.099985
       18     C           -0.169348    -0.088768    -0.087016
       19     C           -0.059928     0.006916    -0.005096
       20     C           -0.038476     0.010626     0.002045
       21     C           -0.137986    -0.052534    -0.056717
       22     C           -0.154260    -0.094904    -0.081970
       23     C           -0.072053    -0.053537    -0.047738
       24     C           -0.088418    -0.043317    -0.046472
       25     C           -0.025616    -0.037055     0.000915
       26     C           -0.025758    -0.039806    -0.000276
       27     C           -0.107324    -0.044610    -0.044409
       28     C           -0.107831    -0.039804    -0.046648
       29     C           -0.185423    -0.151088    -0.128342
       30     C           -0.084500    -0.041282    -0.040035
       31     C           -0.070153    -0.045442    -0.036893
       32     C           -0.034185    -0.008701     0.014309
       33     C           -0.059330    -0.010679     0.004267
       34     C           -0.035974    -0.046885    -0.035621
       35     C           -0.040633    -0.053112    -0.037538
       36     C           -0.038371    -0.056938    -0.019637
       37     C           -0.034467    -0.055265    -0.019209
       38     C           -0.010778     0.005233     0.028622
       39     C           -0.008364     0.002873     0.027851
       40     C           -0.074891    -0.042884    -0.045303
       41     C           -0.064980    -0.046496    -0.043545
       42     C           -0.067089    -0.019397     0.011464
       43     C           -0.106959    -0.037137    -0.043870
       44     C           -0.127673    -0.039221    -0.050866
       45     C            0.018482     0.015851     0.024619
       46     C            0.012389     0.006709     0.024671
       47     C           -0.034244    -0.038193    -0.016963
       48     C           -0.031832    -0.032254    -0.015054
       49     C           -0.082709    -0.078018    -0.044876
       50     C           -0.081218    -0.073005    -0.045893
       51     C           -0.101071    -0.039853    -0.050384
       52     C           -0.106166    -0.046985    -0.055545
       53     C           -0.066249    -0.073775    -0.034538
       54     C           -0.074876    -0.066876    -0.034073
       55     C           -0.084705    -0.065120    -0.055458
       56     C           -0.078436    -0.060395    -0.051188
       57     C           -0.033914    -0.040003    -0.024047
       58     C           -0.038742    -0.044510    -0.027015
       59     C           -0.067102    -0.063352    -0.044178
       60     C           -0.063243    -0.058498    -0.037999
       61     C           -0.053723    -0.049244    -0.035089
       62     C           -0.050768    -0.051351    -0.034332
       63     C           -0.039943    -0.013561    -0.007064
       64     C           -0.037387    -0.011510    -0.006526
       65     C           -0.110271    -0.097706    -0.066931
       66     C           -0.123280    -0.102139    -0.075984
       67     C           -0.076382    -0.019494    -0.047511
       68     C           -0.077720    -0.019157    -0.048881
       69     C           -0.028313    -0.040260     0.013702
       70     C           -0.107797    -0.090246    -0.041054
       71     C           -0.079936    -0.008578    -0.022298
       72     C           -0.079340    -0.008857    -0.022631
       73     C           -0.067478    -0.015242    -0.016472
       74     C           -0.065326    -0.017551    -0.016087
       75     C           -0.084820    -0.032011    -0.044740
       76     C           -0.095196    -0.030611    -0.026378
       77     C           -0.104437    -0.031428    -0.021139
       78     C           -0.099938    -0.028898    -0.018023
       79     C           -0.138332    -0.061493    -0.049031
       80     C           -0.137518    -0.058157    -0.047431
       81     C           -0.144286    -0.121826    -0.093276
       82     C           -0.143299    -0.120784    -0.091902
       83     Y            3.043933     1.806456     1.554775
       84     N           -2.552872    -1.595216    -1.794638
       85     Y            2.860509     1.788338     1.525501
       86     Y            2.811973     1.731643     1.466280

       

.. container:: formalpara-title

   **Output text**

.. code:: xml

   <comment class="example.output" id="atomic.charges">
           <module cmlx:lineCount="96" cmlx:templateRef="atomic.charges">
               <list cmlx:lineCount="86" cmlx:templateRef="multipole">
                   <array dataType="xsd:integer" dictRef="cc:serial" size="86">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86</array>
                   <array dataType="xsd:string" dictRef="cc:elementType" size="86">C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C C Y N Y Y</array>
                   <array dataType="xsd:double" dictRef="a:mdcm" size="86">-0.075557 -0.084875 -0.085796 -0.080729 -0.117513 -0.010384 -0.014865 -0.039447 -0.035558 -0.140545 -0.093525 -0.087944 -0.051656 -0.063214 -0.059823 -0.057707 -0.174511 -0.169348 -0.059928 -0.038476 -0.137986 -0.15426 -0.072053 -0.088418 -0.025616 -0.025758 -0.107324 -0.107831 -0.185423 -0.0845 -0.070153 -0.034185 -0.05933 -0.035974 -0.040633 -0.038371 -0.034467 -0.010778 -0.008364 -0.074891 -0.06498 -0.067089 -0.106959 -0.127673 0.018482 0.012389 -0.034244 -0.031832 -0.082709 -0.081218 -0.101071 -0.106166 -0.066249 -0.074876 -0.084705 -0.078436 -0.033914 -0.038742 -0.067102 -0.063243 -0.053723 -0.050768 -0.039943 -0.037387 -0.110271 -0.12328 -0.076382 -0.07772 -0.028313 -0.107797 -0.079936 -0.07934 -0.067478 -0.065326 -0.08482 -0.095196 -0.104437 -0.099938 -0.138332 -0.137518 -0.144286 -0.143299 3.043933 -2.552872 2.860509 2.811973</array>
                   <array dataType="xsd:double" dictRef="a:mdcd" size="86">-0.078482 -0.084295 -0.033633 -0.032957 -0.057666 -0.016576 -0.013944 0.005299 0.002807 -0.112301 -0.025081 -0.021211 -0.037707 -0.036357 -0.080014 -0.086737 -0.110768 -0.088768 0.006916 0.010626 -0.052534 -0.094904 -0.053537 -0.043317 -0.037055 -0.039806 -0.04461 -0.039804 -0.151088 -0.041282 -0.045442 -0.008701 -0.010679 -0.046885 -0.053112 -0.056938 -0.055265 0.005233 0.002873 -0.042884 -0.046496 -0.019397 -0.037137 -0.039221 0.015851 0.006709 -0.038193 -0.032254 -0.078018 -0.073005 -0.039853 -0.046985 -0.073775 -0.066876 -0.06512 -0.060395 -0.040003 -0.04451 -0.063352 -0.058498 -0.049244 -0.051351 -0.013561 -0.01151 -0.097706 -0.102139 -0.019494 -0.019157 -0.04026 -0.090246 -0.008578 -0.008857 -0.015242 -0.017551 -0.032011 -0.030611 -0.031428 -0.028898 -0.061493 -0.058157 -0.121826 -0.120784 1.806456 -1.595216 1.788338 1.731643</array>
                   <array dataType="xsd:double" dictRef="a:mdcq" size="86">-0.054478 -0.061208 -0.042267 -0.040164 -0.037879 0.016869 0.017432 -0.007335 -0.00628 -0.069237 -0.031398 -0.021392 -0.042409 -0.045044 -0.046854 -0.045563 -0.099985 -0.087016 -0.005096 0.002045 -0.056717 -0.08197 -0.047738 -0.046472 9.15E-4 -2.76E-4 -0.044409 -0.046648 -0.128342 -0.040035 -0.036893 0.014309 0.004267 -0.035621 -0.037538 -0.019637 -0.019209 0.028622 0.027851 -0.045303 -0.043545 0.011464 -0.04387 -0.050866 0.024619 0.024671 -0.016963 -0.015054 -0.044876 -0.045893 -0.050384 -0.055545 -0.034538 -0.034073 -0.055458 -0.051188 -0.024047 -0.027015 -0.044178 -0.037999 -0.035089 -0.034332 -0.007064 -0.006526 -0.066931 -0.075984 -0.047511 -0.048881 0.013702 -0.041054 -0.022298 -0.022631 -0.016472 -0.016087 -0.04474 -0.026378 -0.021139 -0.018023 -0.049031 -0.047431 -0.093276 -0.091902 1.554775 -1.794638 1.525501 1.46628</array>
               </list>
           </module>
       </comment>

.. container:: formalpara-title

   **Template definition**

.. code:: xml

   <templateList>  <template pattern="\s*Atom\s+Level.*" endPattern="~">    <record repeat="2" />    <record id="multipole" repeat="*" makeArray="true">{I,cc:serial}{A,cc:elementType}{F,a:mdcm}{F,a:mdcd}{F,a:mdcq}</record>
           </template>   
       </templateList>
   <transform process="pullup" xpath=".//cml:list[@cmlx:templateRef='multipole']" />
   <transform process="delete" xpath=".//cml:list[count(*)=0]" />
   <transform process="delete" xpath=".//cml:list[count(*)=0]" />
   <transform process="delete" xpath=".//cml:module[count(*)=0]" />

.. |image1| image:: ../../imgs/Total.png
.. |image2| image:: ../../imgs/Total.png
