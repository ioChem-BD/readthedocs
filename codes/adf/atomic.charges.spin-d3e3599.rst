.. _atomic.charges.spin-d3e3599:

atomic.charges.spin
===================

.. table:: Implementation level

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Type                                                                                                                       | Status                                                                                                                     |
   +============================================================================================================================+============================================================================================================================+
   | CML extraction template                                                                                                    | |image1|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | HTML5 representation                                                                                                       | |image2|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. table:: Template attributes

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Attribute                                                                                                                  | Value                                                                                                                      |
   +============================================================================================================================+============================================================================================================================+
   | *source*                                                                                                                   | ADF log                                                                                                                    |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | id                                                                                                                         | atomic.charges.spin                                                                                                        |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | name                                                                                                                       | Multipole derived atomic charges (a.u.)                                                                                    |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | pattern                                                                                                                    | &#92;s+MDC&#92;satomic&#92;scharges&#92;s&#92;(spinA&#92;s&#92;+&#92;sspinB&#92;).\*                                       |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | endPattern                                                                                                                 | &#92;s*&#92;d+&#92;s+[a-zA-Z]+.*$&#92;s\*                                                                                  |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | offset                                                                                                                     | -1                                                                                                                         |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | endOffset                                                                                                                  | 1                                                                                                                          |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | repeat                                                                                                                     | \*                                                                                                                         |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | xml:base                                                                                                                   | multipole/atomic.charges.spin.xml                                                                                          |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. container:: formalpara-title

   **Input**

::

    ---------------------------------- 
    MDC atomic charges (spinA + spinB)
    ---------------------------------- 

    The MDC-m charges are just the Monopole terms in the multipole expansion, while for the MDC-d charges
    also the Dipoles are reconstructed. The usually preferred charges are the MDC-q charges.
    These reconstruct the Monopoles, Dipoles and Quadrupoles (both atomic AND molecular).

    Given here are the atomic charges of both spins added. These should be compared
    to the values from a "normal" RESTRICTED calculation.

           Atom    Level:     MDC-m        MDC-d        MDC-q
    ---------------------------------------------------------
        1     W            3.000972     2.177370     2.207192
        2     W            3.000972     2.177370     2.207192
        3     W            3.043655     2.208777     2.237784
        4     W            3.043655     2.208777     2.237784
        5     W            3.000972     2.177370     2.207192
        6     W            3.000972     2.177370     2.207192
        7     W            3.043655     2.208777     2.237784
        8     W            3.043655     2.208777     2.237784
        9     V            2.054217     1.502788     1.529753
       10     W            3.037809     2.192558     2.221109
       11     O           -1.183864    -0.653286    -0.702534
       12     O           -1.226655    -0.685052    -0.735446
       13     O           -1.162829    -0.907201    -0.903050
       14     O           -1.162829    -0.907201    -0.903050
       15     O           -1.162829    -0.907201    -0.903050
       16     O           -1.162829    -0.907201    -0.903050
       17     O           -1.182133    -0.923290    -0.927429
       18     O           -1.182133    -0.923290    -0.927429
       19     O           -1.182133    -0.923290    -0.927429
       20     O           -1.182133    -0.923290    -0.927429
       21     O           -1.080338    -0.890870    -0.892511
       22     O           -1.080338    -0.890870    -0.892511
       23     O           -1.187710    -0.966622    -0.963185
       24     O           -1.187710    -0.966622    -0.963185
       25     O           -1.164405    -0.870966    -0.926617
       26     O           -1.164405    -0.870966    -0.926617
       27     O           -1.080338    -0.890870    -0.892511
       28     O           -1.080338    -0.890870    -0.892511
       29     O           -1.187710    -0.966622    -0.963185
       30     O           -1.187710    -0.966622    -0.963185
       31     O           -1.164405    -0.870966    -0.926617
       32     O           -1.164405    -0.870966    -0.926617
       33     O           -0.976690    -0.765843    -0.762622
       34     O           -0.976690    -0.765843    -0.762622
       35     O           -0.987418    -0.774929    -0.763233
       36     O           -0.987418    -0.774929    -0.763233
       37     O           -0.828075    -0.668503    -0.680506
       38     O           -1.065854    -0.834207    -0.857692
       39     O           -0.976690    -0.765843    -0.762622
       40     O           -0.976690    -0.765843    -0.762622
       41     O           -0.987418    -0.774929    -0.763233
       42     O           -0.987418    -0.774929    -0.763233
    
       

.. container:: formalpara-title

   **Output text**

.. code:: xml

   <comment class="example.output" id="atomic.charges.spin">
           <module cmlx:lineCount="55" cmlx:templateRef="atomic.charges.spin">       
               <list cmlx:lineCount="42" cmlx:templateRef="spin">
                   <array dataType="xsd:integer" dictRef="cc:serial" size="42">1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42</array>
                   <array dataType="xsd:string" dictRef="cc:elementType" size="42">W W W W W W W W V W O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O O</array>
                   <array dataType="xsd:double" dictRef="a:mdcm" size="42">3.000972 3.000972 3.043655 3.043655 3.000972 3.000972 3.043655 3.043655 2.054217 3.037809 -1.183864 -1.226655 -1.162829 -1.162829 -1.162829 -1.162829 -1.182133 -1.182133 -1.182133 -1.182133 -1.080338 -1.080338 -1.18771 -1.18771 -1.164405 -1.164405 -1.080338 -1.080338 -1.18771 -1.18771 -1.164405 -1.164405 -0.97669 -0.97669 -0.987418 -0.987418 -0.828075 -1.065854 -0.97669 -0.97669 -0.987418 -0.987418</array>
                   <array dataType="xsd:double" dictRef="a:mdcd" size="42">2.17737 2.17737 2.208777 2.208777 2.17737 2.17737 2.208777 2.208777 1.502788 2.192558 -0.653286 -0.685052 -0.907201 -0.907201 -0.907201 -0.907201 -0.92329 -0.92329 -0.92329 -0.92329 -0.89087 -0.89087 -0.966622 -0.966622 -0.870966 -0.870966 -0.89087 -0.89087 -0.966622 -0.966622 -0.870966 -0.870966 -0.765843 -0.765843 -0.774929 -0.774929 -0.668503 -0.834207 -0.765843 -0.765843 -0.774929 -0.774929</array>
                   <array dataType="xsd:double" dictRef="a:mdcq" size="42">2.207192 2.207192 2.237784 2.237784 2.207192 2.207192 2.237784 2.237784 1.529753 2.221109 -0.702534 -0.735446 -0.90305 -0.90305 -0.90305 -0.90305 -0.927429 -0.927429 -0.927429 -0.927429 -0.892511 -0.892511 -0.963185 -0.963185 -0.926617 -0.926617 -0.892511 -0.892511 -0.963185 -0.963185 -0.926617 -0.926617 -0.762622 -0.762622 -0.763233 -0.763233 -0.680506 -0.857692 -0.762622 -0.762622 -0.763233 -0.763233</array>
               </list>
           </module>
       </comment>

.. container:: formalpara-title

   **Template definition**

.. code:: xml

   <templateList>  <template pattern="\s*Atom\s+Level.*" endPattern="~">    <record repeat="2" />    <record id="spin" repeat="*" makeArray="true">{I,cc:serial}{A,cc:elementType}{F,a:mdcm}{F,a:mdcd}{F,a:mdcq}</record>
           </template>   
       </templateList>
   <transform process="pullup" xpath=".//cml:list[@cmlx:templateRef='spin']" />
   <transform process="delete" xpath=".//cml:list[count(*)=0]" />
   <transform process="delete" xpath=".//cml:list[count(*)=0]" />
   <transform process="delete" xpath=".//cml:module[count(*)=0]" />

.. |image1| image:: ../../imgs/Total.png
.. |image2| image:: ../../imgs/None.png
