.. _castep.geom-d3e51588:

castep.geom
===========

.. table:: Implementation level

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Type                                                                                                                       | Status                                                                                                                     |
   +============================================================================================================================+============================================================================================================================+
   | CML extraction template                                                                                                    | |image1|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | HTML5 representation                                                                                                       | |image2|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. table:: Template attributes

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Attribute                                                                                                                  | Value                                                                                                                      |
   +============================================================================================================================+============================================================================================================================+
   | *source*                                                                                                                   | CASTEP geom file                                                                                                           |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | id                                                                                                                         | castep.geom                                                                                                                |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | name                                                                                                                       | CASTEP geom file                                                                                                           |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | xml:base                                                                                                                   | topTemplate.xml                                                                                                            |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. container:: formalpara-title

   **Input**

::

    BEGIN header
     
    CASTEP calculation from Materials Studio                                        
    END header
     
                                         0                                     F   F   F   F            &-- c
                        -5.0078005415924089E+001   -5.0078005415924089E+001                             &-- E
                         1.0262214418141220E+001    0.0000000000000000E+000    0.0000000000000000E+000  &-- h
                         0.0000000000000000E+000    1.0262214418141220E+001    0.0000000000000000E+000  &-- h
                         0.0000000000000000E+000    0.0000000000000000E+000    1.0262214418141220E+001  &-- h
                        -1.2285877876718027E-004    4.2351647362715017E-022   -4.2351647362715017E-022  &-- S
                         4.2351647362715017E-022   -1.2285877876718040E-004    0.0000000000000000E+000  &-- S
                        -4.2351647362715017E-022    0.0000000000000000E+000   -1.2285877876718019E-004  &-- S
    Si              1    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- R
    Si              2    0.0000000000000000E+000    5.1311072090706089E+000    5.1311072090706089E+000  &-- R
    Si              3    5.1311072090706089E+000    0.0000000000000000E+000    5.1311072090706089E+000  &-- R
    Si              4    5.1311072090706089E+000    5.1311072090706089E+000    0.0000000000000000E+000  &-- R
    Si              5    7.6966608136059138E+000    2.5655536045353049E+000    7.6966608136059138E+000  &-- R
    Si              6    2.5655536045353049E+000    2.5655536045353049E+000    2.5655536045353049E+000  &-- R
    Si              7    2.5655536045353049E+000    7.6966608136059138E+000    7.6966608136059138E+000  &-- R
    Si              8    7.6966608136059138E+000    7.6966608136059138E+000    2.5655536045353049E+000  &-- R
    Si              1    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              2    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              3    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              4    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              5    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              6    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              7    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              8    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
       
                                         3                                     T   T   T   T            &-- c
                        -5.0080304782430773E+001   -5.0080304782430773E+001                             &-- E
                         1.0405743066368817E+001    3.8200054405598108E-037    2.6136879330146068E-037  &-- h
                         3.8200054405598108E-037    1.0405743066368817E+001    3.2168466867872084E-037  &-- h
                         2.6136879330146068E-037    3.2168466867872084E-037    1.0405743066368817E+001  &-- h
                         1.1138356651379254E-007    0.0000000000000000E+000    2.1175823681357508E-022  &-- S
                         0.0000000000000000E+000    1.1138356651379600E-007    0.0000000000000000E+000  &-- S
                         2.1175823681357508E-022    0.0000000000000000E+000    1.1138356651380637E-007  &-- S
    Si              1    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- R
    Si              2    3.2168466867872079E-037    5.2028715331844078E+000    5.2028715331844078E+000  &-- R
    Si              3    5.2028715331844078E+000    3.5184260636735089E-037    5.2028715331844078E+000  &-- R
    Si              4    5.2028715331844078E+000    5.2028715331844078E+000    2.9152673099009069E-037  &-- R
    Si              5    7.8043072997766121E+000    2.6014357665922043E+000    7.8043072997766121E+000  &-- R
    Si              6    2.6014357665922043E+000    2.6014357665922043E+000    2.6014357665922043E+000  &-- R
    Si              7    2.6014357665922043E+000    7.8043072997766121E+000    7.8043072997766121E+000  &-- R
    Si              8    7.8043072997766121E+000    7.8043072997766121E+000    2.6014357665922043E+000  &-- R
    Si              1    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              2    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              3    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              4    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              5    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              6    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              7    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
    Si              8    0.0000000000000000E+000    0.0000000000000000E+000    0.0000000000000000E+000  &-- F
     
    BEGIN footer
     Hirshfeld analysis of final structure
    Si              1 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              2 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              3 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              4 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              5 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              6 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              7 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    Si              8 H charge=   0.00 H spin=  -0.00                                                    &-- HQS
    END footer 
       

.. container:: formalpara-title

   **Output text**

.. code:: xml
   :number-lines:

   <comment class="example.output" id="castep.geom">
           <module id="castep.geom">
                 <module cmlx:templateRef="header">
                       <scalar dataType="xsd:string" dictRef="cc:title">BEGIN header</scalar>
                 </module>
                 <module cmlx:templateRef="section">
                       <molecule id="initial">
                             <crystal>
                                   <scalar id="sc1" title="a" units="nonsi:angstrom">5.4305303944401055</scalar>
                                   <scalar id="sc2" title="b" units="nonsi:angstrom">5.4305303944401055</scalar>
                                   <scalar id="sc3" title="c" units="nonsi:angstrom">5.4305303944401055</scalar>
                                   <scalar id="sc4" title="alpha" units="nonsi:degree">90.0</scalar>
                                   <scalar id="sc5" title="beta" units="nonsi:degree">90.0</scalar>
                                   <scalar id="sc6" title="gamma" units="nonsi:degree">90.0</scalar>
                             </crystal>
                             <atomArray>
                                   <atom elementType="Si" id="a1" x3="0.0000" xFract="0.0000" y3="0.0000" yFract="0.0000" z3="0.0000" zFract="0.0000" />
                                   <atom elementType="Si" id="a2" x3="0.0000" xFract="0.0000" y3="2.7152652" yFract="0.5000" z3="2.7152652" zFract="0.5000" />
                                   <atom elementType="Si" id="a3" x3="2.7152652" xFract="0.5000" y3="0.0000" yFract="0.0000" z3="2.7152652" zFract="0.5000" />
                                   <atom elementType="Si" id="a4" x3="2.7152652" xFract="0.5000" y3="2.7152652" yFract="0.5000" z3="0.0000" zFract="0.0000" />
                                   <atom elementType="Si" id="a5" x3="4.0728978" xFract="0.7500" y3="1.3576326" yFract="0.2500" z3="4.0728978" zFract="0.7500" />
                                   <atom elementType="Si" id="a6" x3="1.3576326" xFract="0.2500" y3="1.3576326" yFract="0.2500" z3="1.3576326" zFract="0.2500" />
                                   <atom elementType="Si" id="a7" x3="1.3576326" xFract="0.2500" y3="4.0728978" yFract="0.7500" z3="4.0728978" zFract="0.7500" />
                                   <atom elementType="Si" id="a8" x3="4.0728978" xFract="0.7500" y3="4.0728978" yFract="0.7500" z3="1.3576326" zFract="0.2500" />
                             </atomArray>
                             <bondArray />
                             <formula concise="Si8">
                                   <atomArray count="8" elementType="Si" />
                             </formula>
                             <property dictRef="cml:molmass">
                                   <scalar units="unit:dalton">224.684</scalar>
                             </property>
                       </molecule>
                       <list dictRef="ca:axis" id="axis">
                             <array dataType="xsd:double" dictRef="cc:latticeA" size="3">5.4305303944401055 0.0 0.0</array>
                             <array dataType="xsd:double" dictRef="cc:latticeB" size="3">0.0 5.4305303944401055 0.0</array>
                             <array dataType="xsd:double" dictRef="cc:latticeC" size="3">0.0 0.0 5.4305303944401055</array>
                       </list>
                       <scalar dataType="xsd:integer" dictRef="ca:niter">0</scalar>
                       <scalar dataType="xsd:string" dictRef="ca:convergence">F F F F</scalar>
                       <scalar dataType="xsd:double" dictRef="cc:finalEnergy">-1362.6918613673529</scalar>
                       <scalar dataType="xsd:double" dictRef="ca:enthalpy">-1362.6918613673529</scalar>
                 </module>
                 <module cmlx:templateRef="section">
                       <molecule id="final">
                             <crystal>
                                   <scalar id="sc1" title="a" units="nonsi:angstrom">5.506482489661875</scalar>
                                   <scalar id="sc2" title="b" units="nonsi:angstrom">5.506482489661875</scalar>
                                   <scalar id="sc3" title="c" units="nonsi:angstrom">5.506482489661875</scalar>
                                   <scalar id="sc4" title="alpha" units="nonsi:degree">90.0</scalar>
                                   <scalar id="sc5" title="beta" units="nonsi:degree">90.0</scalar>
                                   <scalar id="sc6" title="gamma" units="nonsi:degree">90.0</scalar>
                             </crystal>
                             <atomArray>
                                   <atom elementType="Si" id="a9" x3="0.0000" xFract="0.0000" y3="0.0000" yFract="0.0000" z3="0.0000" zFract="0.0000" />
                                   <atom elementType="Si" id="a10" x3="0.0000" xFract="-0.0000" y3="2.75324124" yFract="0.5000" z3="2.75324124" zFract="0.5000" />
                                   <atom elementType="Si" id="a11" x3="2.75324124" xFract="0.5000" y3="0.0000" yFract="-0.0000" z3="2.75324124" zFract="0.5000" />
                                   <atom elementType="Si" id="a12" x3="2.75324124" xFract="0.5000" y3="2.75324124" yFract="0.5000" z3="0.0000" zFract="-0.0000" />
                                   <atom elementType="Si" id="a13" x3="4.12986187" xFract="0.7500" y3="1.37662062" yFract="0.2500" z3="4.12986187" zFract="0.7500" />
                                   <atom elementType="Si" id="a14" x3="1.37662062" xFract="0.2500" y3="1.37662062" yFract="0.2500" z3="1.37662062" zFract="0.2500" />
                                   <atom elementType="Si" id="a15" x3="1.37662062" xFract="0.2500" y3="4.12986187" yFract="0.7500" z3="4.12986187" zFract="0.7500" />
                                   <atom elementType="Si" id="a16" x3="4.12986187" xFract="0.7500" y3="4.12986187" yFract="0.7500" z3="1.37662062" zFract="0.2500" />
                             </atomArray>
                             <bondArray />
                             <formula concise="Si8">
                                   <atomArray count="8" elementType="Si" />
                             </formula>
                             <property dictRef="cml:molmass">
                                   <scalar units="unit:dalton">224.684</scalar>
                             </property>
                       </molecule>
                       <list dictRef="ca:axis" id="axis">
                             <array dataType="xsd:double" dictRef="cc:latticeA" size="3">5.506482489661875 2.0214599702004734E-37 1.3831041901371658E-37</array>
                             <array dataType="xsd:double" dictRef="cc:latticeB" size="3">2.0214599702004734E-37 5.506482489661875 1.7022820801688194E-37</array>
                             <array dataType="xsd:double" dictRef="cc:latticeC" size="3">1.3831041901371658E-37 1.7022820801688194E-37 5.506482489661875</array>
                       </list>
                       <scalar dataType="xsd:integer" dictRef="ca:niter">3</scalar>
                       <scalar dataType="xsd:string" dictRef="ca:convergence">T T T T</scalar>
                       <scalar dataType="xsd:double" dictRef="cc:finalEnergy">-1362.7544303135187</scalar>
                       <scalar dataType="xsd:double" dictRef="ca:enthalpy">-1362.7544303135187</scalar>
                 </module>
           </module>
       </comment>

.. container:: formalpara-title

   **Template definition**

.. code:: xml
   :number-lines:

   <templateList>  <template id="header" pattern="\s*BEGIN\sheader.*" endPattern="\s*END\sheader.*">    <record repeat="*">\s*</record>    <record>{X,cc:title}</record>    <transform process="pullup" xpath=".//cml:scalar" />    <transform process="delete" xpath=".//cml:list" />
           </template>  <template id="section" pattern="\s{20,}[0-9].*" endPattern="\s*" endPattern2="~" repeat="*" keep="firstandlast">    <record>{I,ca:niter}{X,ca:convergence}.--\s*c</record>    <record>{E,cc:finalEnergy}{E,ca:enthalpy}.*--\s*E</record>    <record>{3E,cc:latticeA}.*--\s*h</record>    <record>{3E,cc:latticeB}.*--\s*h</record>    <record>{3E,cc:latticeC}.*--\s*h</record>    <record repeat="*">.*--\s*S</record>    <record repeat="*" id="atom">\s*{A,cc:elementType}{I,cc:serial}{E,cc:x3}{E,cc:y3}{E,cc:z3}.*--\s*R</record>    <transform process="operateScalar" xpath=".//cml:scalar[@dictRef='cc:finalEnergy' or @dictRef='ca:enthalpy']" args="operator=multiply operand=27.21139" />    <transform process="operateArray" xpath=".//cml:array[@dictRef='cc:latticeA' or @dictRef='cc:latticeB' or @dictRef='cc:latticeC']" args="operator=multiply operand=0.529177249" />    <transform process="operateScalar" xpath=".//cml:scalar[@dictRef='cc:x3' or @dictRef='cc:y3' or @dictRef='cc:z3']" args="operator=multiply operand=0.529177249" />    <transform process="addChild" xpath=".//cml:list[@cmlx:templateRef='atom']/cml:list" elementName="cml:atom" id="atom" />    <transform process="addAttribute" xpath=".//cml:atom" name="id" value="$string(concat('a', count(preceding::cml:atom)+1))" />    <transform process="addAttribute" xpath=".//cml:atom" name="elementType" value="$string(preceding-sibling::cml:scalar[@dictRef='cc:elementType']/text())" />    <transform process="addAttribute" xpath=".//cml:atom" name="x3" value="$string(preceding-sibling::cml:scalar[@dictRef='cc:x3']/text())" />    <transform process="addAttribute" xpath=".//cml:atom" name="y3" value="$string(preceding-sibling::cml:scalar[@dictRef='cc:y3']/text())" />    <transform process="addAttribute" xpath=".//cml:atom" name="z3" value="$string(preceding-sibling::cml:scalar[@dictRef='cc:z3']/text())" />    <transform process="setValue" xpath=".//cml:atom" value="$string(preceding-sibling::cml:scalar[@dictRef='cc:elementType']/text())" />    <transform process="addChild" xpath="." elementName="cml:atomArray" />    <transform process="move" xpath=".//cml:atom" to="./cml:atomArray" />    <transform process="addChild" xpath="." elementName="cml:list" id="axis" />    <transform process="addAttribute" xpath=".//cml:list[@id='axis']" name="dictRef" value="ca:axis" />    <transform process="move" xpath=".//cml:array[@dictRef='cc:latticeA']" to=".//cml:list[@id='axis']" />    <transform process="move" xpath=".//cml:array[@dictRef='cc:latticeB']" to=".//cml:list[@id='axis']" />    <transform process="move" xpath=".//cml:array[@dictRef='cc:latticeC']" to=".//cml:list[@id='axis']" />    <transform process="createCrystal" xpath=".//cml:atomArray" lattice=".//cml:list[@dictRef='ca:axis']" id="coordinates" connect="no" />    <transform process="delete" xpath="./cml:atomArray" />    <transform process="delete" xpath=".//cml:list[@cmlx:templateRef='atom']" />    <transform process="move" xpath=".//cml:scalar[@dictRef='ca:niter' or @dictRef='ca:convergence' or @dictRef='cc:finalEnergy' or @dictRef='ca:enthalpy']" to="." />    <transform process="delete" xpath=".//cml:list[count(*) = 0]" />    <transform process="delete" xpath=".//cml:list[count(*) = 0]" />                        
           </template>  <transform process="addAttribute" xpath="(.//cml:molecule)[1]" name="id" value="initial" />  <transform process="addAttribute" xpath="(.//cml:molecule)[last()]" name="id" value="final" />
           
       </templateList>

.. |image1| image:: ../../imgs/Total.png
.. |image2| image:: ../../imgs/Total.png
