.. _atom.expansion-d3e36825:

atom.expansion
==============

.. table:: Implementation level

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Type                                                                                                                       | Status                                                                                                                     |
   +============================================================================================================================+============================================================================================================================+
   | CML extraction template                                                                                                    | |image1|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | HTML5 representation                                                                                                       | |image2|                                                                                                                   |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. table:: Template attributes

   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | Attribute                                                                                                                  | Value                                                                                                                      |
   +============================================================================================================================+============================================================================================================================+
   | *source*                                                                                                                   | MOLCAS log                                                                                                                 |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | id                                                                                                                         | atom.expansion                                                                                                             |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | name                                                                                                                       | Multipole expansion for Atoms                                                                                              |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | pattern                                                                                                                    | &#92;s*Multipole&#92;sexpansion&#92;sfor&#92;sAtoms&#92;s\*                                                                |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | endPattern                                                                                                                 | &#92;s*Quadrupole.*$&#92;s\*                                                                                               |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | repeat                                                                                                                     | \*                                                                                                                         |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | endOffset                                                                                                                  | 1                                                                                                                          |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+
   | xml:base                                                                                                                   | modules/multipole/atom.expansion.xml                                                                                       |
   +----------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------+

.. container:: formalpara-title

   **Input**

::

    Multipole expansion for Atoms
    *****************************
    
       1 Atom       1   C1        
    **************************************************
    Coord                -0.84693608      1.56153837      0.00000000
    Charge                0.46466842
    Dipole               -0.31439205     -0.59156970     -0.01270304
    Quadrupole           -2.54058690      0.55551308      0.00207019     -1.97448269     -0.01795433     -3.72046636
    Polarizability        5.69713910      2.37630411     -0.12113305      8.33901278     -0.13142690      5.10107617
    
       2 Atom       2   C2        
    **************************************************
    Coord                 1.78953422      1.56153837      0.00000000
    Charge               -0.19706266
    Dipole               -0.24696952      0.41206168      0.00136523
    Quadrupole           -3.89149899     -0.23294868      0.03228644     -4.19336343      0.01025287     -4.60817052
    Polarizability        7.51927886     -3.19860941     -0.02843215     13.29941542     -0.09682608      6.84174130
    
       3 Atom       3   C3        
    **************************************************
    Coord                 3.10769001      3.84385699      0.00000000
    Charge               -0.27844951
    Dipole               -0.56411692     -0.09388781      0.02022266
    Quadrupole           -4.06987789     -0.23090863      0.02073284     -4.45140264     -0.01970057     -4.70506987
    Polarizability       13.75715174      0.05297448     -0.00343449      5.85916741      0.02466135      6.85569916
    
       4 Atom       4   C4        
    **************************************************
    Coord                 1.78931502      6.12760802     -0.00226578
    Charge                0.39954585
    Dipole                0.34524404      0.26832244      0.02033704
    Quadrupole           -2.43304595      0.12781155     -0.03943609     -2.51870592     -0.18682088     -3.72201265
    Polarizability        5.81427340      2.45309262     -0.13530530      9.08274525      0.20740200      4.72466507
    
       5 Atom       5   C5        
    **************************************************
    Coord                -0.84652222      6.12746062     -0.00317096
    Charge               -0.20248038
    Dipole                0.17009815     -0.46670197      0.04409797
    Quadrupole           -3.99041206     -0.25189648     -0.02700626     -4.25074151     -0.02648937     -4.60023952
    Polarizability        7.66497782     -3.38677192      0.07199204     11.48046540     -0.08528472      6.98776643
    
       6 Atom       6   C6        
    **************************************************
    Coord                -2.16479706      3.84428218     -0.00128879
    Charge               -0.20588361
    Dipole                0.44606407     -0.01571884     -0.03459215
    Quadrupole           -4.03435923     -0.22638483     -0.05455493     -4.16953543     -0.01254124     -4.62720944
    Polarizability       15.08051271      0.79018693     -0.01476013      6.25929149      0.04224224      6.75760625
    
       7 Atom       7   H7        
    **************************************************
    Coord                 2.82795385     -0.23845033      0.00248499
    Charge                0.17444234
    Dipole                0.05320521     -0.06273914      0.00080646
    Quadrupole           -0.42709180     -0.07682424      0.00084548     -0.30772479      0.00006639     -0.50364047
    Polarizability        1.82059660     -1.71231903      0.00698627      4.37523398     -0.01669012      1.11762919
    
       8 Atom       8   H8        
    **************************************************
    Coord                 5.18578403      3.84400817      0.00119809
    Charge                0.16358134
    Dipole                0.08818788     -0.02564272      0.00149191
    Quadrupole           -0.29463334      0.03306381      0.01104682     -0.45711115      0.00166007     -0.49002008
    Polarizability        4.68546034     -0.11419090      0.02476167      0.90884331     -0.00231597      1.08286816
    
       9 Atom       9   H9        
    **************************************************
    Coord                -1.88610214      7.92701090     -0.00497187
    Charge                0.16581545
    Dipole               -0.05358475      0.07796849      0.00385790
    Quadrupole           -0.44126827     -0.05312350      0.00294646     -0.32022970     -0.00226962     -0.50125780
    Polarizability        2.01934037     -1.71989633     -0.00206720      3.70822420     -0.00614824      1.09863451
    
      10 Atom      10   H10       
    **************************************************
    Coord                -4.24274746      3.84462800     -0.00162894
    Charge                0.17098693
    Dipole               -0.08680722      0.00820226     -0.00440158
    Quadrupole           -0.28412499      0.00214765     -0.00699988     -0.46631596     -0.00060299     -0.50599843
    Polarizability        5.20130309      0.20877928     -0.03987304      0.99249838      0.00070341      1.11079123
    
      11 Atom      11   F11       
    **************************************************
    Coord                -2.12239414     -0.64786683      0.00104402
    Charge               -0.44872810
    Dipole                0.04407320      0.07633563      0.00114219
    Quadrupole           -3.66714875      0.29767139     -0.00059423     -3.32498770     -0.00032175     -3.83226156
    Polarizability        4.32835432      2.56879807      0.01243024      7.19706944      0.00277683      2.69596661
    
      12 Atom      12   O12       
    **************************************************
    Coord                 3.14135372      8.46736480     -0.00241076
    Charge               -0.48646954
    Dipole               -0.20846701     -0.15556409      0.08918542
    Quadrupole           -4.08925092      0.62491478     -0.07331212     -3.44318095      0.01021684     -4.41876675
    Polarizability        4.29182960      0.56022895      0.68160359      7.05788513      1.01757728      4.36442122
    
      13 Atom      13   H13       
    **************************************************
    Coord                 4.50769054      8.37715364     -1.19240192
    Charge                0.28003349
    Dipole                0.14779129     -0.10527692     -0.19127435
    Quadrupole           -0.40921996      0.14964391      0.03194066     -0.46327081     -0.09879275     -0.55871050
    Polarizability        3.26599728      1.92948067     -1.30106255      1.97523087     -1.04899605      1.27619527
    
    
    
     SUMMED MULTIPOLES AND POLARIZABILITY FOR THE MOLECULE
     *****************************************************
    
    Coord                 0.00000000      0.00000000      0.00000000
    Charge               -0.00000000
    Dipole                0.53073300      0.16593964     -0.39414386
    Quadrupole          -27.91150595     -0.65737358     -2.18827711    -36.68585495     -3.51839161    -35.94023878
    Polarizability       81.14621524      0.80805752     -0.84829411     80.53508304     -0.09232498     50.01506056
    
    
    Coord                 0.00000000      0.00000000      0.00000000
    Charge               -0.00000000
    Dipole                0.53073300      0.16593964     -0.39414386
    Quadrupole          -27.91150595     -0.65737358     -2.18827711    -36.68585495     -3.51839161    -35.94023878
       

.. container:: formalpara-title

   **Output text**

.. code:: xml
   :number-lines:

   <comment class="example.output" id="atom.expansion">
           <module cmlx:templateRef="atom.expansion">       
              <scalar dataType="xsd:double" dictRef="m:atomicchargesum">-0.00000000</scalar>
              <array dataType="xsd:integer" dictRef="cc:serial" size="13">1 2 3 4 5 6 7 8 9 10 11 12 13</array>
              <array dataType="xsd:string" dictRef="m:label" size="13">C1 C2 C3 C4 C5 C6 H7 H8 H9 H10 F11 O12 H13</array>
              <array dataType="xsd:double" dictRef="m:atomiccharge" size="13">0.46466842 -0.19706266 -0.27844951 0.39954585 -0.20248038 -0.20588361 0.17444234 0.16358134 0.16581545 0.17098693 -0.44872810 -0.48646954 0.28003349</array>
              <array dataType="xsd:double" dictRef="x:coordssum" size="3">0.00000000 0.00000000 0.00000000</array>
              <array dataType="xsd:double" dictRef="m:atomicdipolesum" size="3">0.53073300 0.16593964 -0.39414386</array>
              <array dataType="xsd:double" dictRef="m:atomicquadrupolesum" size="6">-27.91150595 -0.65737358 -2.18827711 -36.68585495 -3.51839161 -35.94023878</array>
              <array dataType="xsd:double" dictRef="m:atomicpolarizabilitysum" size="6">81.14621524 0.80805752 -0.84829411 80.53508304 -0.09232498 50.01506056</array>
              <matrix cols="3" dataType="xsd:double" dictRef="x:coords" rows="13">-0.84693608 1.56153837 0.00000000 1.78953422 1.56153837 0.00000000 3.10769001 3.84385699 0.00000000 1.78931502 6.12760802 -0.00226578 -0.84652222 6.12746062 -0.00317096 -2.16479706 3.84428218 -0.00128879 2.82795385 -0.23845033 0.00248499 5.18578403 3.84400817 0.00119809 -1.88610214 7.92701090 -0.00497187 -4.24274746 3.84462800 -0.00162894 -2.12239414 -0.64786683 0.00104402 3.14135372 8.46736480 -0.00241076 4.50769054 8.37715364 -1.19240192</matrix>
              <matrix cols="3" dataType="xsd:double" dictRef="m:atomicdipole" rows="13">-0.31439205 -0.59156970 -0.01270304 -0.24696952 0.41206168 0.00136523 -0.56411692 -0.09388781 0.02022266 0.34524404 0.26832244 0.02033704 0.17009815 -0.46670197 0.04409797 0.44606407 -0.01571884 -0.03459215 0.05320521 -0.06273914 0.00080646 0.08818788 -0.02564272 0.00149191 -0.05358475 0.07796849 0.00385790 -0.08680722 0.00820226 -0.00440158 0.04407320 0.07633563 0.00114219 -0.20846701 -0.15556409 0.08918542 0.14779129 -0.10527692 -0.19127435</matrix>
              <matrix cols="6" dataType="xsd:double" dictRef="m:atomicquadrupole" rows="13">-2.54058690 0.55551308 0.00207019 -1.97448269 -0.01795433 -3.72046636 -3.89149899 -0.23294868 0.03228644 -4.19336343 0.01025287 -4.60817052 -4.06987789 -0.23090863 0.02073284 -4.45140264 -0.01970057 -4.70506987 -2.43304595 0.12781155 -0.03943609 -2.51870592 -0.18682088 -3.72201265 -3.99041206 -0.25189648 -0.02700626 -4.25074151 -0.02648937 -4.60023952 -4.03435923 -0.22638483 -0.05455493 -4.16953543 -0.01254124 -4.62720944 -0.42709180 -0.07682424 0.00084548 -0.30772479 0.00006639 -0.50364047 -0.29463334 0.03306381 0.01104682 -0.45711115 0.00166007 -0.49002008 -0.44126827 -0.05312350 0.00294646 -0.32022970 -0.00226962 -0.50125780 -0.28412499 0.00214765 -0.00699988 -0.46631596 -0.00060299 -0.50599843 -3.66714875 0.29767139 -0.00059423 -3.32498770 -0.00032175 -3.83226156 -4.08925092 0.62491478 -0.07331212 -3.44318095 0.01021684 -4.41876675 -0.40921996 0.14964391 0.03194066 -0.46327081 -0.09879275 -0.55871050</matrix>
              <matrix cols="6" dataType="xsd:double" dictRef="m:atomicpolarizability" rows="13">5.69713910 2.37630411 -0.12113305 8.33901278 -0.13142690 5.10107617 7.51927886 -3.19860941 -0.02843215 13.29941542 -0.09682608 6.84174130 13.75715174 0.05297448 -0.00343449 5.85916741 0.02466135 6.85569916 5.81427340 2.45309262 -0.13530530 9.08274525 0.20740200 4.72466507 7.66497782 -3.38677192 0.07199204 11.48046540 -0.08528472 6.98776643 15.08051271 0.79018693 -0.01476013 6.25929149 0.04224224 6.75760625 1.82059660 -1.71231903 0.00698627 4.37523398 -0.01669012 1.11762919 4.68546034 -0.11419090 0.02476167 0.90884331 -0.00231597 1.08286816 2.01934037 -1.71989633 -0.00206720 3.70822420 -0.00614824 1.09863451 5.20130309 0.20877928 -0.03987304 0.99249838 0.00070341 1.11079123 4.32835432 2.56879807 0.01243024 7.19706944 0.00277683 2.69596661 4.29182960 0.56022895 0.68160359 7.05788513 1.01757728 4.36442122 3.26599728 1.92948067 -1.30106255 1.97523087 -1.04899605 1.27619527</matrix>
           </module>
       </comment>

.. container:: formalpara-title

   **Template definition**

.. code:: xml
   :number-lines:

   <templateList>  <template id="atom" pattern="\s*[0-9]+\s*Atom.*" endPattern="\s*" endPattern2="~" repeat="*">    <record>.*Atom{I,cc:serial}{A,m:label}</record>    <record />    <record>\s*Coord{3F,x:coords}</record>    <record>\s*Charge{F,m:atomiccharge}</record>    <record>\s*Dipole{3F,m:atomicdipole}</record>    <record>\s*Quadrupole{6F,m:atomicquadrupole}</record>    <record>\s*Polarizability{6F,m:atomicpolarizability}</record>
           </template>  <template id="sum" pattern="\s*SUMMED\sMULTIPOLES\sAND\sPOLARIZABILITY\sFOR\sTHE\sMOLECULE.*" endPattern="~">    <record repeat="3" />    <record>\s*Coord{3F,x:coordssum}</record>    <record>\s*Charge{F,m:atomicchargesum}</record>    <record>\s*Dipole{3F,m:atomicdipolesum}</record>    <record>\s*Quadrupole{6F,m:atomicquadrupolesum}</record>    <record>\s*Polarizability{6F,m:atomicpolarizabilitysum}</record>           
           </template>
       </templateList>
   <transform process="createArray" xpath="." from=".//cml:scalar[@dictRef='cc:serial']" />
   <transform process="createArray" xpath="." from=".//cml:scalar[@dictRef='m:label']" />
   <transform process="createArray" xpath="." from=".//cml:scalar[@dictRef='m:atomiccharge']" />
   <transform process="createMatrix" xpath="." from=".//cml:array[@dictRef='x:coords']" dictRef="x:coords" />
   <transform process="createMatrix" xpath="." from=".//cml:array[@dictRef='m:atomicdipole']" dictRef="m:atomicdipole" />
   <transform process="createMatrix" xpath="." from=".//cml:array[@dictRef='m:atomicquadrupole']" dictRef="m:atomicquadrupole" />
   <transform process="createMatrix" xpath="." from=".//cml:array[@dictRef='m:atomicpolarizability']" dictRef="m:atomicpolarizability" />
   <transform process="move" xpath=".//cml:scalar" to="." />
   <transform process="move" xpath=".//cml:array" to="." />
   <transform process="move" xpath=".//cml:matrix" to="." />
   <transform process="delete" xpath=".//cml:list[count(*)= 0 ]" />
   <transform process="delete" xpath=".//cml:list[count(*)= 0 ]" />
   <transform process="delete" xpath=".//cml:module[count(*)= 0 ]" />

.. |image1| image:: ../../imgs/Total.png
.. |image2| image:: ../../imgs/Total.png
